import{s as d,a as l,p as x,g as c,m as B,b as F,i as p}from"./utils-CGS83D2H.js";document.addEventListener("DOMContentLoaded",()=>{C();const t=document.getElementById("website_input"),e=document.getElementById("add_sites"),n=document.getElementById("clear_sites");e&&t&&(e.addEventListener("click",()=>v(t)),t.addEventListener("keypress",s=>{s.key==="Enter"&&v(t)})),n&&n.addEventListener("click",()=>I("wordspotting_website_list",u));const i=document.getElementById("bl_word_input"),r=document.getElementById("add_bl_word"),o=document.getElementById("clear_keywords");r&&i&&(r.addEventListener("click",()=>b(i)),i.addEventListener("keypress",s=>{s.key==="Enter"&&b(i)})),o&&o.addEventListener("click",()=>I("wordspotting_word_list",_)),document.getElementById("notifications_switch")?.addEventListener("change",function(){const s=this.checked;d({wordspotting_notifications_on:s}).then(()=>{l(`Notifications turned ${s?"ON":"OFF"}`,"Settings Saved",!0)})}),document.getElementById("extension_switch")?.addEventListener("change",function(){const s=this.checked;d({wordspotting_extension_on:s}).then(()=>{l(`Extension turned ${s?"ON":"OFF"}`,"Settings Saved",!0)})});const a=document.getElementById("highlight_switch"),h=document.getElementById("highlight_color_row");a&&h&&a.addEventListener("change",function(){const s=this.checked;h.style.display=s?"flex":"none",d({wordspotting_highlight_on:s}).then(()=>{l(`Highlighting turned ${s?"ON":"OFF"}`,"Settings Saved",!0)})});const f=document.getElementById("highlight_color_input");f&&f.addEventListener("change",function(){const s=this.value;d({wordspotting_highlight_color:s}).then(()=>{})});const m=document.getElementById("theme_select");m&&m.addEventListener("change",()=>{const s=m.value;L(s),d({wordspotting_theme:s})}),document.body.addEventListener("click",s=>{const w=s.target;if(w?.classList.contains("chip")){const y=w.dataset.type,E=w.dataset.index;if(y&&E){const S=parseInt(E,10);A(y,S)}}})});function v(t){const e=t.value;if(!e||!e.trim()){g(t);return}const n=e.split(",").map(o=>o.trim()).filter(o=>o.length>0);if(n.length===0){g(t);return}const{valid:i,invalid:r}=x(n);if(r.length>0&&l(`Skipped invalid pattern(s): ${r.join(", ")}`,"Validation",!1),i.length===0){g(t);return}c("wordspotting_website_list").then(o=>{const a=Array.isArray(o.wordspotting_website_list)?o.wordspotting_website_list:[],h=B(a,i);return d({wordspotting_website_list:h})}).then(()=>{t.value="",u(),l("Website(s) added.","Success",!0)}).catch(console.error)}function b(t){const e=t.value;if(!e||!e.trim()){g(t);return}const n=e.split(",").map(o=>o.trim()).filter(o=>o.length>0);if(n.length===0){g(t);return}const{valid:i,invalid:r}=F(n);if(r.length>0&&l(`Skipped invalid regex: ${r.join(", ")}`,"Validation",!1),i.length===0){g(t);return}c("wordspotting_word_list").then(o=>{const a=Array.isArray(o.wordspotting_word_list)?o.wordspotting_word_list:[],h=B(a,i);return d({wordspotting_word_list:h})}).then(()=>{t.value="",_(),l("Keyword(s) added.","Success",!0)}).catch(console.error)}function A(t,e){const n=t==="site"?"wordspotting_website_list":"wordspotting_word_list";c(n).then(i=>{const r=i[n];if(p(r))return r.splice(e,1),d({[n]:r})}).then(()=>{t==="site"?u():_()})}function I(t,e){confirm("Are you sure you want to clear this list?")&&d({[t]:[]}).then(()=>{e(),l("List cleared.","Success",!0)})}function C(){u(),N(),O(),T(),_(),D()}function u(){c("wordspotting_website_list").then(t=>{const e=t.wordspotting_website_list,n=document.getElementById("website_list_container");n&&(n.innerHTML="",p(e)&&e.length>0?e.forEach((i,r)=>{const o=k(i,r,"site");n.appendChild(o)}):n.innerHTML="<small>No sites added.</small>")})}function _(){c("wordspotting_word_list").then(t=>{const e=t.wordspotting_word_list,n=document.getElementById("bl_word_list_container");n&&(n.innerHTML="",p(e)&&e.length>0?e.forEach((i,r)=>{const o=k(i,r,"word");n.appendChild(o)}):n.innerHTML="<small>No keywords added.</small>")})}function k(t,e,n){const i=document.createElement("button");return i.type="button",i.className="chip",i.textContent=t,i.dataset.index=String(e),i.dataset.type=n,i.title="Click to remove",i.setAttribute("aria-label",`Remove ${t}`),i}function N(){c("wordspotting_notifications_on").then(t=>{const e=t.wordspotting_notifications_on,n=document.getElementById("notifications_switch");n&&(n.checked=e!==!1)})}function O(){c("wordspotting_extension_on").then(t=>{const e=t.wordspotting_extension_on,n=document.getElementById("extension_switch");n&&(n.checked=e!==!1)})}function T(){c(["wordspotting_highlight_on","wordspotting_highlight_color"]).then(t=>{const e=t.wordspotting_highlight_on===!0,n=t.wordspotting_highlight_color||"#FFFF00",i=document.getElementById("highlight_switch"),r=document.getElementById("highlight_color_input"),o=document.getElementById("highlight_color_row");i&&(i.checked=e),r&&(r.value=n),o&&(o.style.display=e?"flex":"none")})}function g(t){t.style.borderColor="var(--danger-color)",setTimeout(()=>{t.style.borderColor="var(--border-color)"},500)}function D(){c("wordspotting_theme").then(t=>{const e=t.wordspotting_theme||"system",n=document.getElementById("theme_select");n&&(n.value=e),L(e)})}function L(t){const e=document.documentElement;t==="light"?e.setAttribute("data-theme","light"):t==="dark"?e.setAttribute("data-theme","dark"):e.removeAttribute("data-theme")}
